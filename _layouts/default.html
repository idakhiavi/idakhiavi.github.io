<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>{% if page.title %}{{ page.title }} — {% endif %}{{ site.title }}</title>
<link rel="stylesheet" href="{{ "/assets/styles.css?v=4" | relative_url }}">
<!-- Arcade font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<!-- Body font to match arcade vibe but readable -->
<link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600;700&display=swap" rel="stylesheet">
<meta name="description" content="{{ site.description }}">
</head>
<body class="arcade">
<header class="site-header">
  <div class="inner">
    <div class="brand-and-nav">
      <a class="brand" href="{{ "/" | relative_url }}">Ida Khiavi</a>
      <nav class="tabs">
        <!-- labels lower-case, no leading slash; href goes to full URL paths -->
        <a href="{{ site.url }}/contact">contact</a>
        <a href="{{ site.url }}/resume">resume</a>
        <a href="{{ site.url }}/aboutme">aboutme</a>
        <span class="sep">|</span>
        <a href="{{ "/" | relative_url }}">home</a>
        <a href="{{ "/archive/" | relative_url }}">archive</a>
      </nav>
    </div>
    <p class="tagline">{{ site.description }}</p>
    <p class="social">
      <a href="https://github.com/idakhiavi">GitHub</a>
      <a href="https://www.linkedin.com/in/idakhiavi">LinkedIn</a>
      <a href="XXX">Publication</a>
    </p>
  </div>
</header>

<main class="container">
  <div class="grid">
    <section class="main">
      {{ content }}
    </section>
    <aside class="sidebar" aria-label="Archive">
      <div class="card">
        <h3>Archive</h3>
        <ul>
          {% assign posts_by_month = site.posts | group_by_exp: "post", "post.date | date: '%Y-%m'" | sort: 'name' | reverse %}
          {% if posts_by_month and posts_by_month.size > 0 %}
            {% for month in posts_by_month %}
              {% assign anchor = month.name %}
              {% assign label = month.items[0].date | date: '%B %Y' %}
              <li><a href="{{ '/archive/#' | append: anchor | relative_url }}">{{ label }}</a></li>
            {% endfor %}
          {% else %}
            <li><em>No posts yet</em></li>
          {% endif %}
        </ul>

        <h3 style="margin-top:14px">Tags</h3>
        {% assign tags_raw = '' %}
        {% for post in site.posts %}
          {% assign segments = post.content | strip_html | split: '#' %}
          {% for s in segments offset:1 %}
            {% if s and s != '' and s | slice: 0, 1 != ' ' %}
              {% assign token = s | strip | split: ' ' | first %}
              {% assign token = token | replace: ',', '' | replace: '.', '' | replace: '!', '' | replace: '?', '' | replace: ';', '' | replace: ':', '' | replace: ')', '' | replace: '(', '' | replace: ']', '' | replace: '[', '' | replace: '"', '' | replace: "'", '' %}
              {% if token != '' %}
                {% capture tags_raw %}{{ tags_raw }}|{{ token }}{% endcapture %}
              {% endif %}
            {% endif %}
          {% endfor %}
        {% endfor %}
        {% assign tags_all = tags_raw | split: '|' %}
        {% assign tag_list = tags_all | uniq | sort %}
        <ul class="tag-cloud">
          {% for tag in tag_list %}
            {% if tag != '' %}
              {% assign tag_count = 0 %}
              {% for p in site.posts %}
                {% assign found = '' %}
                {% assign segs = p.content | strip_html | split: '#' %}
                {% for z in segs offset:1 %}
                  {% if z and z != '' and z | slice: 0, 1 != ' ' %}
                    {% assign tok = z | strip | split: ' ' | first %}
                    {% assign tok = tok | replace: ',', '' | replace: '.', '' | replace: '!', '' | replace: '?', '' | replace: ';', '' | replace: ':', '' | replace: ')', '' | replace: '(', '' | replace: ']', '' | replace: '[', '' | replace: '"', '' | replace: "'", '' %}
                    {% if tok == tag %}
                      {% assign found = '1' %}
                    {% endif %}
                  {% endif %}
                {% endfor %}
                {% if found != '' %}
                  {% assign tag_count = tag_count | plus: 1 %}
                {% endif %}
              {% endfor %}
              {% assign size_class = 'tag-size-1' %}
              {% if tag_count > 3 %}
                {% assign size_class = 'tag-size-3' %}
              {% elsif tag_count > 1 %}
                {% assign size_class = 'tag-size-2' %}
              {% endif %}
              {% assign color_index = tag | size | modulo: 4 %}
              {% case color_index %}
                {% when 0 %}
                  {% assign color_class = 'tag-color-purple' %}
                {% when 1 %}
                  {% assign color_class = 'tag-color-yellow' %}
                {% when 2 %}
                  {% assign color_class = 'tag-color-blue' %}
                {% else %}
                  {% assign color_class = 'tag-color-red' %}
              {% endcase %}
              <li><a class="tag-chip {{ size_class }} {{ color_class }}" href="{{ '/tags/#' | append: tag | relative_url }}">#{{ tag }}</a></li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </aside>
  </div>
</main>

<footer class="site-footer">
  © <span id="y"></span> Ida Khiavi • <span style="color:var(--accent2)">Ida's place</span>
</footer>

<script>
document.getElementById('y').textContent = new Date().getFullYear();
</script>
</body>
</html>
